f = values[values['totalviewtime'] > pd.Timedelta(seconds = 5)]
learning - values greater than 5 seconds
---------------------------------------------------------------------------------------------------
total_users = pd.unique(
    facebook_friends[['user1', 'user2']].values.ravel()
).size
â€œFind the total number of distinct users that appear in either user1 or user2.â€

Step-by-step breakdown
ğŸ”¹ Step 1: Select both columns
facebook_friends[['user1', 'user2']]


This creates a DataFrame like:

user1	user2
1	2
2	3
1	3
ğŸ”¹ Step 2: .values
.values


Converts the DataFrame into a NumPy array:

array([[1, 2],
       [2, 3],
       [1, 3]])

ğŸ”¹ Step 3: .ravel()
.values.ravel()


Flattens the 2D array into 1D

â€œUnrollsâ€ the columns row by row

Result:

array([1, 2, 2, 3, 1, 3])


Now all users are in one list.

ğŸ”¹ Step 4: pd.unique(...)
pd.unique([1, 2, 2, 3, 1, 3])


Returns unique values, preserving order:

array([1, 2, 3])

ğŸ”¹ Step 5: .size
.size


Counts how many unique users exist:

3

ğŸ¯ Final result
learning - take out unique values from two columns
------------------------------------------------------------------------------------------------
https://platform.stratascratch.com/coding/2059-player-with-longest-streak?code_type=2
consecutive streaks - longest win streak

use -shift, cumsum

# Import your libraries
import pandas as pd

# Start writing code
players_results.head()
df = players_results.sort_values(by = ['player_id', 'match_date'])
df['iswin']  =df['match_result'].apply(lambda x : 1 if x  == 'W' else 0)
df['iswinshift'] = df.groupby('player_id')['iswin'].shift(1)
df['playeridshift'] = df['player_id'].shift()
df['streakbreak'] = (df['iswin'] != df['iswinshift']) | (df['player_id'] != df['playeridshift'])
df['streak_id'] = df['streakbreak'].cumsum()

wins = df[df['iswin'] == 1]

streak_lengths = (
    wins
    .groupby(['player_id', 'streak_id'])
    .size().reset_index()
)
streak_lengths

------------------------------------------------------------------------------------------------
values['genderratio'] = np.where(values['F'].notna(), (values['M'] / values['F']).round(2), 'NULL')

calcualte ratio, if female is null, put 'NULL' in ratio, else calcualte
